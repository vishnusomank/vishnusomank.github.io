<!DOCTYPE html>
<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js">
    </script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <link href="./.static/main.css" rel="stylesheet" />
    <script type="text/javascript">
        function showHideRow(row) {
            $("#" + row).toggle();
        }
    </script>
    <title>Security Report</title>
    <div span class="v38_6838">Security Report (18-May-2023 21:35:02)</span> </div>
</head>

<body>
    <div class="v38_7029"></div>
<div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/carts:0.4.8</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-carts</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row1');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row1" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: carts
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row2');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row2" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: carts
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row3');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row3" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: carts
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row4');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row4" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row5');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row5" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row6');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row6" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row7');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row7" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row8');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row8" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row9');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row9" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row10');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row10" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row11');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row11" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row12');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row12" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row13');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row13" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row14');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row14" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: carts
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row15');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-carts-0-4-8-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row15" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-weaveworksdemos-carts-0-4-8-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: carts
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: mongo</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/ubuntu</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-carts-db</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row16');">
				
					
						<td>
							<span class="v38_6848">mongo-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row16" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: carts-db
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row17');">
				
					
						<td>
							<span class="v38_6848">mongo-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row17" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: carts-db
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row18');">
				
					
						<td>
							<span class="v38_6848">mongo-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row18" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: carts-db
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row19');">
				
					
						<td>
							<span class="v38_6848">mongo-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row19" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row20');">
				
					
						<td>
							<span class="v38_6848">mongo-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row20" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row21');">
				
					
						<td>
							<span class="v38_6848">mongo-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row21" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row22');">
				
					
						<td>
							<span class="v38_6848">mongo-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row22" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row23');">
				
					
						<td>
							<span class="v38_6848">mongo-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row23" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row24');">
				
					
						<td>
							<span class="v38_6848">mongo-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row24" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row25');">
				
					
						<td>
							<span class="v38_6848">mongo-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row25" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row26');">
				
					
						<td>
							<span class="v38_6848">mongo-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row26" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row27');">
				
					
						<td>
							<span class="v38_6848">mongo-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row27" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row28');">
				
					
						<td>
							<span class="v38_6848">mongo-file-system-mounts.yaml</span>
						</td>
					
				
					
						<td>Ensure successful file system mounts are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.14_file_system_mount</td>	
					
				

					
            </tr>
            <tr id="row28" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-file-system-mounts
  namespace: sock-shop
spec:
  action: Audit
  message: Alert! file system mount detected
  process:
    matchPaths:
    - path: /bin/mount
    - path: /usr/bin/mount
    - path: /bin/umount
    - path: /usr/bin/umount
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.14_file_system_mount

</pre>
					<h3>Description</h3>
					It is highly unusual for a non privileged user to mount file systems to the system. While tracking mount commands gives the system administrator evidence that external media may have been mounted (based on a review of the source of the mount and confirming it&#39;s an external media type), it does not conclusively indicate that data was exported to the media. System administrators who wish to determine if data were exported, would also have to track successful open , create and truncate system calls requiring write access to a file under the mount point of the external media file system. This could give a fair indication that a write occurred. The only way to truly prove it, would be to track successful writes to the external media. Tracking write system calls could quickly fill up the audit log and is not recommended. Recommendations on configuration options to track data export to media is beyond the scope of this document.
					<br>
					<h3>References</h3>
					
					CIS_4.1.14_file_system_mount: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row29');">
				
					
						<td>
							<span class="v38_6848">mongo-access-ctrl-permission-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure discretionary access control permission modification events are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.11_system_access_control_permission</td>	
					
				

					
            </tr>
            <tr id="row29" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-access-ctrl-permission-mod
  namespace: sock-shop
spec:
  action: Block
  message: Alert! access control permission modification detected
  process:
    matchPaths:
    - path: /usr/bin/chmod
    - path: /usr/bin/chown
    - path: /bin/chmod
    - path: /bin/chown
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.11_system_access_control_permission

</pre>
					<h3>Description</h3>
					Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for system calls that affect file permissions and attributes. The chmod , fchmod and fchmodat system calls affect the permissions associated with a file. The chown , fchown , fchownat and lchown system calls affect owner and group attributes on a file. The setxattr , lsetxattr , fsetxattr (set extended file attributes) and removexattr , lremovexattr , fremovexattr (remove extended file attributes) control extended file attributes. In all cases, an audit record will only be written for non-system user ids (auid &gt;= 500) and will ignore Daemon events (auid = 4294967295). All audit records will be tagged with the identifier &#34;perm_mod.&#34; Monitoring for changes in file attributes could alert a system administrator to activity that could indicate intruder activity or policy violation.
					<br>
					<h3>References</h3>
					
					CIS_4.1.11_system_access_control_permission: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row30');">
				
					
						<td>
							<span class="v38_6848">mongo-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row30" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: carts-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row31');">
				
					
						<td>
							<span class="v38_6848">mongo-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row31" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: carts-db-mongo-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: carts-db
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/catalogue:0.3.5</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-catalogue</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row32');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row32" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: catalogue
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row33');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row33" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: catalogue
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row34');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row34" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: catalogue
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row35');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row35" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row36');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row36" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row37');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row37" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row38');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row38" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row39');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row39" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row40');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row40" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row41');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row41" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row42');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row42" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row43');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row43" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row44');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row44" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row45');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row45" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: catalogue
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row46');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-0-3-5-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row46" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-weaveworksdemos-catalogue-0-3-5-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: catalogue
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/catalogue-db:0.3.0</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/debian</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-catalogue-db</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row47');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-user-grp-mod.yaml</span>
						</td>
					
				
					
						<td>Audit access to useradd and groupadd command!</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MySQL
CIS</td>	
					
				

					
            </tr>
            <tr id="row47" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-user-grp-mod
  namespace: sock-shop
spec:
  action: Block
  message: Notification! useradd and groupadd command executions denied!
  process:
    matchPaths:
    - path: /usr/sbin/groupadd
    - path: /usr/sbin/useradd
  selector:
    matchLabels:
      name: catalogue-db
  severity: 1
  tags:
  - MySQL
  - CIS

</pre>
					<h3>Description</h3>
					Utilizing a least privilege account for MySQL to execute as needed may reduce the impact of a MySQL-born vulnerability. A restricted account will be unable to access resources unrelated to MySQL, such as operating system configurations.
					<br>
					<h3>References</h3>
					
					CIS: [https://learn.cisecurity.org/l/799323/2022-05-31/28qr86//]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row48');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-mysqldump-bin-exec.yaml</span>
						</td>
					
				
					
						<td>Monitor access to mysqldump process</td>	
					
				
					
						<td>
						10/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>MySQL
mysqldump
process</td>	
					
				

					
            </tr>
            <tr id="row48" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-mysqldump-bin-exec
  namespace: sock-shop
spec:
  action: Audit
  message: Alert! mysqldump command execution detected.
  process:
    matchPaths:
    - path: /usr/bin/mysqldump
  selector:
    matchLabels:
      name: catalogue-db
  severity: 10
  tags:
  - MySQL
  - mysqldump
  - process

</pre>
					<h3>Description</h3>
					mysqldump is used to create a MySQL databases logical backup. From the imported dump file, an attacker can manufacture malicious table names to implement arbitrary SQL statements to query and shell command execution purposes.
					<br>
					<h3>References</h3>
					
					MYSQL: [https://www.oracle.com/security-alerts/cpuapr2017.html]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row49');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row49" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: catalogue-db
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row50');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row50" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: catalogue-db
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row51');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row51" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: catalogue-db
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row52');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row52" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row53');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row53" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row54');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row54" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row55');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row55" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row56');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row56" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row57');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row57" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row58');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row58" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row59');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row59" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row60');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row60" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row61');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-file-system-mounts.yaml</span>
						</td>
					
				
					
						<td>Ensure successful file system mounts are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.14_file_system_mount</td>	
					
				

					
            </tr>
            <tr id="row61" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-file-system-mounts
  namespace: sock-shop
spec:
  action: Audit
  message: Alert! file system mount detected
  process:
    matchPaths:
    - path: /bin/mount
    - path: /usr/bin/mount
    - path: /bin/umount
    - path: /usr/bin/umount
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.14_file_system_mount

</pre>
					<h3>Description</h3>
					It is highly unusual for a non privileged user to mount file systems to the system. While tracking mount commands gives the system administrator evidence that external media may have been mounted (based on a review of the source of the mount and confirming it&#39;s an external media type), it does not conclusively indicate that data was exported to the media. System administrators who wish to determine if data were exported, would also have to track successful open , create and truncate system calls requiring write access to a file under the mount point of the external media file system. This could give a fair indication that a write occurred. The only way to truly prove it, would be to track successful writes to the external media. Tracking write system calls could quickly fill up the audit log and is not recommended. Recommendations on configuration options to track data export to media is beyond the scope of this document.
					<br>
					<h3>References</h3>
					
					CIS_4.1.14_file_system_mount: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row62');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row62" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row63');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-access-ctrl-permission-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure discretionary access control permission modification events are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.11_system_access_control_permission</td>	
					
				

					
            </tr>
            <tr id="row63" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-access-ctrl-permission-mod
  namespace: sock-shop
spec:
  action: Block
  message: Alert! access control permission modification detected
  process:
    matchPaths:
    - path: /usr/bin/chmod
    - path: /usr/bin/chown
    - path: /bin/chmod
    - path: /bin/chown
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.11_system_access_control_permission

</pre>
					<h3>Description</h3>
					Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for system calls that affect file permissions and attributes. The chmod , fchmod and fchmodat system calls affect the permissions associated with a file. The chown , fchown , fchownat and lchown system calls affect owner and group attributes on a file. The setxattr , lsetxattr , fsetxattr (set extended file attributes) and removexattr , lremovexattr , fremovexattr (remove extended file attributes) control extended file attributes. In all cases, an audit record will only be written for non-system user ids (auid &gt;= 500) and will ignore Daemon events (auid = 4294967295). All audit records will be tagged with the identifier &#34;perm_mod.&#34; Monitoring for changes in file attributes could alert a system administrator to activity that could indicate intruder activity or policy violation.
					<br>
					<h3>References</h3>
					
					CIS_4.1.11_system_access_control_permission: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row64');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row64" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: catalogue-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row65');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-catalogue-db-0-3-0-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row65" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: catalogue-db-weaveworksdemos-catalogue-db-0-3-0-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: catalogue-db
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/front-end:0.3.12</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-front-end</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row66');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row66" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: front-end
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row67');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row67" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: front-end
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row68');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row68" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: front-end
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row69');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row69" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row70');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row70" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row71');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row71" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row72');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row72" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row73');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row73" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row74');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row74" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row75');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row75" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row76');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row76" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row77');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row77" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row78');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row78" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row79');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row79" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: front-end
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row80');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-front-end-0-3-12-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row80" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: front-end-weaveworksdemos-front-end-0-3-12-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: front-end
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/orders:0.4.7</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-orders</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row81');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row81" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: orders
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row82');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row82" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: orders
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row83');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row83" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: orders
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row84');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row84" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row85');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row85" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row86');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row86" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row87');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row87" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row88');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row88" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row89');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row89" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row90');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row90" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row91');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row91" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row92');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row92" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row93');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row93" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row94');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row94" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: orders
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row95');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-orders-0-4-7-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row95" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-weaveworksdemos-orders-0-4-7-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: orders
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: mongo</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/ubuntu</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-orders-db</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row96');">
				
					
						<td>
							<span class="v38_6848">mongo-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row96" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: orders-db
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row97');">
				
					
						<td>
							<span class="v38_6848">mongo-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row97" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: orders-db
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row98');">
				
					
						<td>
							<span class="v38_6848">mongo-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row98" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: orders-db
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row99');">
				
					
						<td>
							<span class="v38_6848">mongo-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row99" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row100');">
				
					
						<td>
							<span class="v38_6848">mongo-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row100" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row101');">
				
					
						<td>
							<span class="v38_6848">mongo-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row101" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row102');">
				
					
						<td>
							<span class="v38_6848">mongo-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row102" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row103');">
				
					
						<td>
							<span class="v38_6848">mongo-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row103" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row104');">
				
					
						<td>
							<span class="v38_6848">mongo-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row104" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row105');">
				
					
						<td>
							<span class="v38_6848">mongo-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row105" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row106');">
				
					
						<td>
							<span class="v38_6848">mongo-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row106" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row107');">
				
					
						<td>
							<span class="v38_6848">mongo-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row107" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row108');">
				
					
						<td>
							<span class="v38_6848">mongo-file-system-mounts.yaml</span>
						</td>
					
				
					
						<td>Ensure successful file system mounts are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.14_file_system_mount</td>	
					
				

					
            </tr>
            <tr id="row108" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-file-system-mounts
  namespace: sock-shop
spec:
  action: Audit
  message: Alert! file system mount detected
  process:
    matchPaths:
    - path: /bin/mount
    - path: /usr/bin/mount
    - path: /bin/umount
    - path: /usr/bin/umount
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.14_file_system_mount

</pre>
					<h3>Description</h3>
					It is highly unusual for a non privileged user to mount file systems to the system. While tracking mount commands gives the system administrator evidence that external media may have been mounted (based on a review of the source of the mount and confirming it&#39;s an external media type), it does not conclusively indicate that data was exported to the media. System administrators who wish to determine if data were exported, would also have to track successful open , create and truncate system calls requiring write access to a file under the mount point of the external media file system. This could give a fair indication that a write occurred. The only way to truly prove it, would be to track successful writes to the external media. Tracking write system calls could quickly fill up the audit log and is not recommended. Recommendations on configuration options to track data export to media is beyond the scope of this document.
					<br>
					<h3>References</h3>
					
					CIS_4.1.14_file_system_mount: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row109');">
				
					
						<td>
							<span class="v38_6848">mongo-access-ctrl-permission-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure discretionary access control permission modification events are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.11_system_access_control_permission</td>	
					
				

					
            </tr>
            <tr id="row109" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-access-ctrl-permission-mod
  namespace: sock-shop
spec:
  action: Block
  message: Alert! access control permission modification detected
  process:
    matchPaths:
    - path: /usr/bin/chmod
    - path: /usr/bin/chown
    - path: /bin/chmod
    - path: /bin/chown
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.11_system_access_control_permission

</pre>
					<h3>Description</h3>
					Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for system calls that affect file permissions and attributes. The chmod , fchmod and fchmodat system calls affect the permissions associated with a file. The chown , fchown , fchownat and lchown system calls affect owner and group attributes on a file. The setxattr , lsetxattr , fsetxattr (set extended file attributes) and removexattr , lremovexattr , fremovexattr (remove extended file attributes) control extended file attributes. In all cases, an audit record will only be written for non-system user ids (auid &gt;= 500) and will ignore Daemon events (auid = 4294967295). All audit records will be tagged with the identifier &#34;perm_mod.&#34; Monitoring for changes in file attributes could alert a system administrator to activity that could indicate intruder activity or policy violation.
					<br>
					<h3>References</h3>
					
					CIS_4.1.11_system_access_control_permission: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row110');">
				
					
						<td>
							<span class="v38_6848">mongo-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row110" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: orders-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row111');">
				
					
						<td>
							<span class="v38_6848">mongo-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row111" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: orders-db-mongo-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: orders-db
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/payment:0.4.3</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-payment</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row112');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row112" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: payment
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row113');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row113" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: payment
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row114');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row114" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: payment
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row115');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row115" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row116');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row116" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row117');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row117" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row118');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row118" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row119');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row119" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row120');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row120" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row121');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row121" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row122');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row122" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row123');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row123" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row124');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row124" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row125');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row125" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: payment
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row126');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-payment-0-4-3-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row126" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: payment-weaveworksdemos-payment-0-4-3-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: payment
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/queue-master:0.3.1</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-queue-master</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row127');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row127" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: queue-master
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row128');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row128" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: queue-master
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row129');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row129" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: queue-master
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row130');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row130" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row131');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row131" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row132');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row132" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row133');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row133" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row134');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row134" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row135');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row135" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row136');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row136" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row137');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row137" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row138');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row138" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row139');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row139" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row140');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row140" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: queue-master
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row141');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-queue-master-0-3-1-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row141" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: queue-master-weaveworksdemos-queue-master-0-3-1-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: queue-master
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: rabbitmq:3.6.8</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/debian</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-rabbitmq</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row142');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row142" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: rabbitmq
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row143');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row143" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: rabbitmq
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row144');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row144" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: rabbitmq
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row145');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row145" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row146');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row146" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row147');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row147" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row148');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row148" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row149');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row149" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row150');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row150" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row151');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row151" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row152');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row152" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row153');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row153" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row154');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-file-system-mounts.yaml</span>
						</td>
					
				
					
						<td>Ensure successful file system mounts are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.14_file_system_mount</td>	
					
				

					
            </tr>
            <tr id="row154" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-file-system-mounts
  namespace: sock-shop
spec:
  action: Audit
  message: Alert! file system mount detected
  process:
    matchPaths:
    - path: /bin/mount
    - path: /usr/bin/mount
    - path: /bin/umount
    - path: /usr/bin/umount
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.14_file_system_mount

</pre>
					<h3>Description</h3>
					It is highly unusual for a non privileged user to mount file systems to the system. While tracking mount commands gives the system administrator evidence that external media may have been mounted (based on a review of the source of the mount and confirming it&#39;s an external media type), it does not conclusively indicate that data was exported to the media. System administrators who wish to determine if data were exported, would also have to track successful open , create and truncate system calls requiring write access to a file under the mount point of the external media file system. This could give a fair indication that a write occurred. The only way to truly prove it, would be to track successful writes to the external media. Tracking write system calls could quickly fill up the audit log and is not recommended. Recommendations on configuration options to track data export to media is beyond the scope of this document.
					<br>
					<h3>References</h3>
					
					CIS_4.1.14_file_system_mount: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row155');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row155" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row156');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-access-ctrl-permission-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure discretionary access control permission modification events are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.11_system_access_control_permission</td>	
					
				

					
            </tr>
            <tr id="row156" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-access-ctrl-permission-mod
  namespace: sock-shop
spec:
  action: Block
  message: Alert! access control permission modification detected
  process:
    matchPaths:
    - path: /usr/bin/chmod
    - path: /usr/bin/chown
    - path: /bin/chmod
    - path: /bin/chown
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.11_system_access_control_permission

</pre>
					<h3>Description</h3>
					Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for system calls that affect file permissions and attributes. The chmod , fchmod and fchmodat system calls affect the permissions associated with a file. The chown , fchown , fchownat and lchown system calls affect owner and group attributes on a file. The setxattr , lsetxattr , fsetxattr (set extended file attributes) and removexattr , lremovexattr , fremovexattr (remove extended file attributes) control extended file attributes. In all cases, an audit record will only be written for non-system user ids (auid &gt;= 500) and will ignore Daemon events (auid = 4294967295). All audit records will be tagged with the identifier &#34;perm_mod.&#34; Monitoring for changes in file attributes could alert a system administrator to activity that could indicate intruder activity or policy violation.
					<br>
					<h3>References</h3>
					
					CIS_4.1.11_system_access_control_permission: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row157');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row157" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: rabbitmq
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row158');">
				
					
						<td>
							<span class="v38_6848">rabbitmq-3-6-8-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row158" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: rabbitmq-rabbitmq-3-6-8-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: rabbitmq
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/shipping:0.4.8</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-shipping</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row159');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row159" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: shipping
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row160');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row160" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: shipping
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row161');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row161" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: shipping
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row162');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row162" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row163');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row163" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row164');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row164" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row165');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row165" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row166');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row166" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row167');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row167" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row168');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row168" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row169');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row169" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row170');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row170" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row171');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row171" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row172');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row172" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: shipping
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row173');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-shipping-0-4-8-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row173" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: shipping-weaveworksdemos-shipping-0-4-8-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: shipping
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/user:0.4.7</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/alpine</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-user</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row174');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row174" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: user
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row175');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row175" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: user
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row176');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row176" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: user
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row177');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row177" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row178');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row178" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row179');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row179" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row180');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row180" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row181');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row181" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row182');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row182" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row183');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row183" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row184');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row184" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row185');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row185" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row186');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row186" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row187');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row187" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: user
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row188');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-0-4-7-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row188" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-weaveworksdemos-user-0-4-7-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: user
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div><div class="div-main">
    <br>
    <div class="v38_6837"></div>
    <div class="wrapper">
	    <table align=center border=0 cellpadding=2>
	        
	            <tr align=left>
		            <td>Container</td>
		            <td>: weaveworksdemos/user-db:0.4.0</td>
	            </tr>
	        
	            <tr align=left>
		            <td>OS/Arch/Distro</td>
		            <td>: linux/amd64/debian</td>
	            </tr>
	        
	            <tr align=left>
		            <td>Output Directory</td>
		            <td>: out/sock-shop-user-db</td>
	            </tr>
	        
	            <tr align=left>
		            <td>policy-template version</td>
		            <td>: v0.2.1</td>
	            </tr>
	        
	    </table>
    </div>
    <div class="div-main">
        <br>
    </div>
    <table border=0 id="table_detail" align=center cellpadding=30 >
        <tr>
            
                <th>POLICY</th>
            
                <th>DESCRIPTION</th>
            
                <th>SEVERITY</th>
            
                <th>ACTION</th>
            
                <th>TAGS</th>
            
        </tr>

            <tr onclick="showHideRow('row189');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-maint-tools-access.yaml</span>
						</td>
					
				
					
						<td>Restrict access to maintenance tools (apk, mii-tool, ...)</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>PCI_DSS
MITRE</td>	
					
				

					
            </tr>
            <tr id="row189" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-maint-tools-access
  namespace: sock-shop
spec:
  action: Audit
  message: restricted maintenance tool access attempt detected
  process:
    matchDirectories:
    - dir: /sbin/
      recursive: true
  selector:
    matchLabels:
      name: user-db
  severity: 1
  tags:
  - PCI_DSS
  - MITRE

</pre>
					<h3>Description</h3>
					Container images might contain maintenance tools which should ideally never be used in prod env, or if used, should be used only in certain time frames. Examples include, dynamic package management tools, mii-tool, iptables etc
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row190');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-trusted-cert-mod.yaml</span>
						</td>
					
				
					
						<td>Restrict access to trusted certificated bundles in the OS image</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1552_unsecured_credentials</td>	
					
				

					
            </tr>
            <tr id="row190" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-trusted-cert-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
  message: Credentials modification denied
  selector:
    matchLabels:
      name: user-db
  severity: 1
  tags:
  - MITRE
  - MITRE_T1552_unsecured_credentials

</pre>
					<h3>Description</h3>
					Operating systems maintain a list of trusted certificates (often called trust bundles) in file system. These bundles decides which authorities are trusted. Subverting these trust controls would essentially allow an adversary to operate as a trusted entity. Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate, a program prompting the user with a warning because it has an attribute set from being downloaded from the Internet, or getting an indication that you are about to connect to an untrusted site.
					<br>
					<h3>References</h3>
					
					MITRE-TTP: [https://attack.mitre.org/techniques/T1553/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row191');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-system-owner-discovery.yaml</span>
						</td>
					
				
					
						<td>System Information Discovery - block system owner discovery commands</td>	
					
				
					
						<td>
						3/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_T1082_system_information_discovery</td>	
					
				

					
            </tr>
            <tr id="row191" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-system-owner-discovery
  namespace: sock-shop
spec:
  action: Block
  message: System owner discovery command execution denied
  process:
    matchPaths:
    - path: /usr/bin/who
    - path: /usr/bin/w
    - path: /usr/bin/id
    - path: /usr/bin/whoami
  selector:
    matchLabels:
      name: user-db
  severity: 3
  tags:
  - MITRE
  - MITRE_T1082_system_information_discovery

</pre>
					<h3>Description</h3>
					An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.
					<br>
					<h3>References</h3>
					
					MITRE-TTP-T1082: [https://attack.mitre.org/techniques/T1082/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row192');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-write-under-bin-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make directory under /bin/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row192" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-write-under-bin-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
  message: Alert! An attempt to write below system binary directories denied.
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row193');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-write-under-dev-dir.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring make files under /dev/</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row193" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-write-under-dev-dir
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /dev/
      readOnly: true
      recursive: true
  message: Alert! File creation under /dev/ directory detected.
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row194');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-cronjob-cfg.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - System Monitoring Detect access to cronjob files</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>NIST
SI-4
NIST_800-53_SI-4
CIS
CIS_Linux
CIS_5.1_Configure_Cron</td>	
					
				

					
            </tr>
            <tr id="row194" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-cronjob-cfg
  namespace: sock-shop
spec:
  action: Audit
  file:
    matchDirectories:
    - dir: /var/spool/cron/
      recursive: true
    - dir: /var/cron/
      recursive: true
    - dir: /etc/cron.d/
      recursive: true
    - dir: /etc/cron.daily/
      recursive: true
    - dir: /etc/cron.hourly/
      recursive: true
    - dir: /etc/cron.monthly/
      recursive: true
    - dir: /etc/cron.weekly/
      recursive: true
    matchPaths:
    - path: /etc/crontab
  message: Alert! Access to cron job files/directories detected.
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - NIST
  - SI-4
  - NIST_800-53_SI-4
  - CIS
  - CIS_Linux
  - CIS_5.1_Configure_Cron

</pre>
					<h3>Description</h3>
					System monitoring includes external and internal monitoring. External monitoring includes the observation of events occurring at system boundaries. Internal monitoring includes the observation of events occurring within the system. Organizations monitor systems, for example, by observing audit activities in real time or by observing other system aspects such as access patterns, characteristics of access, and other actions.
					<br>
					<h3>References</h3>
					
					NIST-SI-4: [https://csf.tools/reference/nist-sp-800-53/r5/si/si-4/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row195');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-pkg-mngr-exec.yaml</span>
						</td>
					
				
					
						<td>System and Information Integrity - Least Functionality deny execution of package manager process in container</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_CM-7(4)
SI-4
process
NIST_800-53_SI-4</td>	
					
				

					
            </tr>
            <tr id="row195" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-pkg-mngr-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! Execution of package management process inside container is denied
  process:
    matchPaths:
    - path: /usr/bin/apt
    - path: /usr/bin/apt-get
    - path: /bin/apt-get
    - path: /sbin/apk
    - path: /bin/apt
    - path: /usr/bin/dpkg
    - path: /bin/dpkg
    - path: /usr/bin/gdebi
    - path: /bin/gdebi
    - path: /usr/bin/make
    - path: /bin/make
    - path: /usr/bin/yum
    - path: /bin/yum
    - path: /usr/bin/rpm
    - path: /bin/rpm
    - path: /usr/bin/dnf
    - path: /bin/dnf
    - path: /usr/bin/pacman
    - path: /usr/sbin/pacman
    - path: /bin/pacman
    - path: /sbin/pacman
    - path: /usr/bin/makepkg
    - path: /usr/sbin/makepkg
    - path: /bin/makepkg
    - path: /sbin/makepkg
    - path: /usr/bin/yaourt
    - path: /usr/sbin/yaourt
    - path: /bin/yaourt
    - path: /sbin/yaourt
    - path: /usr/bin/zypper
    - path: /bin/zypper
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53_CM-7(4)
  - SI-4
  - process
  - NIST_800-53_SI-4

</pre>
					<h3>Description</h3>
					Authorized software programs can be limited to specific versions or from a specific source. To facilitate a comprehensive authorized software process and increase the strength of protection for attacks that bypass application level authorized software, software programs may be decomposed into and monitored at different levels of detail. These levels include applications, application programming interfaces, application modules, scripts, system processes, system services, kernel functions, registries, drivers, and dynamic link libraries.
					<br>
					<h3>References</h3>
					
					NIST-CM-7-5: [https://csf.tools/reference/nist-sp-800-53/r5/cm/cm-7/cm-7-5/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row196');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-k8s-client-tool-exec.yaml</span>
						</td>
					
				
					
						<td>Adversaries may abuse a container administration service to execute commands within a container.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_T1609_container_administration_command
MITRE_TA0002_execution
MITRE_T1610_deploy_container
MITRE
NIST_800-53
NIST_800-53_AU-2
NIST_800-53_SI-4
NIST</td>	
					
				

					
            </tr>
            <tr id="row196" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-k8s-client-tool-exec
  namespace: sock-shop
spec:
  action: Block
  message: Alert! k8s client tool executed inside container.
  process:
    matchPaths:
    - path: /usr/local/bin/kubectl
    - path: /usr/bin/kubectl
    - path: /usr/local/bin/docker
    - path: /usr/bin/docker
    - path: /usr/local/bin/crictl
    - path: /usr/bin/crictl
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - MITRE_T1609_container_administration_command
  - MITRE_TA0002_execution
  - MITRE_T1610_deploy_container
  - MITRE
  - NIST_800-53
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - NIST

</pre>
					<h3>Description</h3>
					Adversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.
					<br>
					<h3>References</h3>
					
					MITRE_T1609_container_administration_command: [https://attack.mitre.org/techniques/T1609/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row197');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-remote-file-copy.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to steal data.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE
MITRE_TA0008_lateral_movement
MITRE_TA0010_exfiltration
MITRE_TA0006_credential_access
MITRE_T1552_unsecured_credentials
NIST_800-53_SI-4(18)
NIST
NIST_800-53
NIST_800-53_SC-4</td>	
					
				

					
            </tr>
            <tr id="row197" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-remote-file-copy
  namespace: sock-shop
spec:
  action: Block
  message: Alert! remote file copy tools execution prevented.
  process:
    matchPaths:
    - path: /usr/bin/rsync
    - path: /bin/rsync
    - path: /usr/bin/scp
    - path: /bin/scp
    - path: /usr/bin/scp
    - path: /bin/scp
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - MITRE
  - MITRE_TA0008_lateral_movement
  - MITRE_TA0010_exfiltration
  - MITRE_TA0006_credential_access
  - MITRE_T1552_unsecured_credentials
  - NIST_800-53_SI-4(18)
  - NIST
  - NIST_800-53
  - NIST_800-53_SC-4

</pre>
					<h3>Description</h3>
					Exfiltration consists of techniques that adversaries may use to steal data from your network. Once they’ve collected data, adversaries often package it to avoid detection while removing it. This can include compression and encryption. Techniques for getting data out of a target network typically include transferring it over their command and control channel or an alternate channel and may also include putting size limits on the transmission.
					<br>
					<h3>References</h3>
					
					MITRE_TA0010_exfiltration: [https://attack.mitre.org/tactics/TA0010/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row198');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-write-in-shm-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to write under shm folder</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>MITRE_execution
MITRE</td>	
					
				

					
            </tr>
            <tr id="row198" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-write-in-shm-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /dev/shm/
      readOnly: true
      recursive: true
  message: Alert! write to /dev/shm folder prevented.
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - MITRE_execution
  - MITRE

</pre>
					<h3>Description</h3>
					The adversary is trying to run malicious code. Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data.
					<br>
					<h3>References</h3>
					
					MITRE_execution: [https://attack.mitre.org/tactics/TA0002/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row199');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-write-etc-dir.yaml</span>
						</td>
					
				
					
						<td>The adversary is trying to avoid being detected.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST_800-53_SI-7
NIST
NIST_800-53_SI-4
NIST_800-53
MITRE_T1562.001_disable_or_modify_tools
MITRE_T1036.005_match_legitimate_name_or_location
MITRE_TA0003_persistence
MITRE
MITRE_T1036_masquerading
MITRE_TA0005_defense_evasion</td>	
					
				

					
            </tr>
            <tr id="row199" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-write-etc-dir
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /etc/
      readOnly: true
      recursive: true
  message: Alert! File creation under /etc/ directory detected.
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - NIST_800-53_SI-7
  - NIST
  - NIST_800-53_SI-4
  - NIST_800-53
  - MITRE_T1562.001_disable_or_modify_tools
  - MITRE_T1036.005_match_legitimate_name_or_location
  - MITRE_TA0003_persistence
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_TA0005_defense_evasion

</pre>
					<h3>Description</h3>
					Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise. Techniques used for defense evasion include uninstalling/disabling security software or obfuscating/encrypting data and scripts. Adversaries also leverage and abuse trusted processes to hide and masquerade their malware. Other tactics’ techniques are cross-listed here when those techniques include the added benefit of subverting defenses.
					<br>
					<h3>References</h3>
					
					MITRE_TA0005_defense_evasion: [https://attack.mitre.org/tactics/TA0005/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row200');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-shell-history-mod.yaml</span>
						</td>
					
				
					
						<td>Adversaries may delete or modify artifacts generated within systems to remove evidence.</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53
NIST_800-53_CM-5
NIST_800-53_AU-6(8)
MITRE_T1070_indicator_removal_on_host
MITRE
MITRE_T1036_masquerading</td>	
					
				

					
            </tr>
            <tr id="row200" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-shell-history-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/mv
      - path: /bin/rm
      - path: /usr/bin/mv
      path: /root/*_history
    - fromSource:
      - path: /usr/bin/shred
      - path: /usr/bin/rm
      - path: /bin/rm
      - path: /bin/mv
      - path: /usr/bin/mv
      path: /home/*/*_history
  message: Alert! shell history modification or deletion detected and prevented
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - NIST
  - NIST_800-53
  - NIST_800-53_CM-5
  - NIST_800-53_AU-6(8)
  - MITRE_T1070_indicator_removal_on_host
  - MITRE
  - MITRE_T1036_masquerading

</pre>
					<h3>Description</h3>
					Adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversary’s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform. Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.
					<br>
					<h3>References</h3>
					
					MITRE_T1070_indicator_removal: [https://attack.mitre.org/techniques/T1070/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row201');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-file-system-mounts.yaml</span>
						</td>
					
				
					
						<td>Ensure successful file system mounts are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6985"><span class="v38_6986">Audit</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.14_file_system_mount</td>	
					
				

					
            </tr>
            <tr id="row201" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-file-system-mounts
  namespace: sock-shop
spec:
  action: Audit
  message: Alert! file system mount detected
  process:
    matchPaths:
    - path: /bin/mount
    - path: /usr/bin/mount
    - path: /bin/umount
    - path: /usr/bin/umount
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.14_file_system_mount

</pre>
					<h3>Description</h3>
					It is highly unusual for a non privileged user to mount file systems to the system. While tracking mount commands gives the system administrator evidence that external media may have been mounted (based on a review of the source of the mount and confirming it&#39;s an external media type), it does not conclusively indicate that data was exported to the media. System administrators who wish to determine if data were exported, would also have to track successful open , create and truncate system calls requiring write access to a file under the mount point of the external media file system. This could give a fair indication that a write occurred. The only way to truly prove it, would be to track successful writes to the external media. Tracking write system calls could quickly fill up the audit log and is not recommended. Recommendations on configuration options to track data export to media is beyond the scope of this document.
					<br>
					<h3>References</h3>
					
					CIS_4.1.14_file_system_mount: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row202');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-cis-commandline-warning-banner.yaml</span>
						</td>
					
				
					
						<td>Command Line Warning Banners</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_1.7_Warning_Banners
CIS_1.7.1_Command_Line_Warning_Banners</td>	
					
				

					
            </tr>
            <tr id="row202" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-cis-commandline-warning-banner
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/motd
      readOnly: true
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
  message: Alert! write to warning banner file for standard command line login detected
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_1.7_Warning_Banners
  - CIS_1.7.1_Command_Line_Warning_Banners

</pre>
					<h3>Description</h3>
					If the file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information.
					<br>
					<h3>References</h3>
					
					CIS_1.7.1_Command_Line_Warning_Banners: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row203');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-access-ctrl-permission-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure discretionary access control permission modification events are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.11_system_access_control_permission</td>	
					
				

					
            </tr>
            <tr id="row203" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-access-ctrl-permission-mod
  namespace: sock-shop
spec:
  action: Block
  message: Alert! access control permission modification detected
  process:
    matchPaths:
    - path: /usr/bin/chmod
    - path: /usr/bin/chown
    - path: /bin/chmod
    - path: /bin/chown
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.11_system_access_control_permission

</pre>
					<h3>Description</h3>
					Monitor changes to file permissions, attributes, ownership and group. The parameters in this section track changes for system calls that affect file permissions and attributes. The chmod , fchmod and fchmodat system calls affect the permissions associated with a file. The chown , fchown , fchownat and lchown system calls affect owner and group attributes on a file. The setxattr , lsetxattr , fsetxattr (set extended file attributes) and removexattr , lremovexattr , fremovexattr (remove extended file attributes) control extended file attributes. In all cases, an audit record will only be written for non-system user ids (auid &gt;= 500) and will ignore Daemon events (auid = 4294967295). All audit records will be tagged with the identifier &#34;perm_mod.&#34; Monitoring for changes in file attributes could alert a system administrator to activity that could indicate intruder activity or policy violation.
					<br>
					<h3>References</h3>
					
					CIS_4.1.11_system_access_control_permission: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row204');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-system-network-env-mod.yaml</span>
						</td>
					
				
					
						<td>Ensure events that modify the system&#39;s network environment are collected</td>	
					
				
					
						<td>
						5/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>CIS
CIS_Linux
CIS_4_Logging_and_Aduditing
CIS_4.1.1_Data_Retention
CIS_4.1.7_system_network_environment</td>	
					
				

					
            </tr>
            <tr id="row204" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-system-network-env-mod
  namespace: sock-shop
spec:
  action: Block
  file:
    matchPaths:
    - path: /etc/issue
      readOnly: true
    - path: /etc/issue.net
      readOnly: true
    - path: /etc/hosts
      readOnly: true
    - path: /etc/sysconfig/network
      readOnly: true
  message: Alert! Modification to system network files detected
  selector:
    matchLabels:
      name: user-db
  severity: 5
  tags:
  - CIS
  - CIS_Linux
  - CIS_4_Logging_and_Aduditing
  - CIS_4.1.1_Data_Retention
  - CIS_4.1.7_system_network_environment

</pre>
					<h3>Description</h3>
					Record changes to network environment files or system calls. The below parameters monitor the sethostname (set the systems host name) or setdomainname (set the systems domainname) system calls, and write an audit event on system call exit. The other parameters monitor the /etc/issue and /etc/issue.net files (messages displayed pre- login), /etc/hosts (file containing host names and associated IP addresses) and /etc/sysconfig/network (directory containing network interface scripts and configurations) files.
					<br>
					<h3>References</h3>
					
					CIS_4.1.7_system_network_environment: [https://www.cisecurity.org/cis-benchmarks/]<br>
					
                </td>
            </tr>
            <tr onclick="showHideRow('row205');">
				
					
						<td>
							<span class="v38_6848">weaveworksdemos-user-db-0-4-0-file-integrity-monitoring.yaml</span>
						</td>
					
				
					
						<td>File Integrity Monitoring</td>	
					
				
					
						<td>
						1/10
						</td>
					
				
					
						
							<td>
								<div class="v38_6859"><span class="v38_6860">Block</span></div>
							</td>
						
					
				
					
						<td>NIST
NIST_800-53_AU-2
NIST_800-53_SI-4
MITRE
MITRE_T1036_masquerading
MITRE_T1565_data_manipulation</td>	
					
				

					
            </tr>
            <tr id="row205" class="hidden_row">
                <td colspan="100%">
					<h3>Kubearmor Security Policy</h3>
<pre>
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: user-db-weaveworksdemos-user-db-0-4-0-file-integrity-monitoring
  namespace: sock-shop
spec:
  action: Block
  file:
    matchDirectories:
    - dir: /sbin/
      readOnly: true
      recursive: true
    - dir: /usr/bin/
      readOnly: true
      recursive: true
    - dir: /usr/lib/
      readOnly: true
      recursive: true
    - dir: /usr/sbin/
      readOnly: true
      recursive: true
    - dir: /bin/
      readOnly: true
      recursive: true
    - dir: /boot/
      readOnly: true
      recursive: true
  message: Detected and prevented compromise to File integrity
  selector:
    matchLabels:
      name: user-db
  severity: 1
  tags:
  - NIST
  - NIST_800-53_AU-2
  - NIST_800-53_SI-4
  - MITRE
  - MITRE_T1036_masquerading
  - MITRE_T1565_data_manipulation

</pre>
					<h3>Description</h3>
					Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
					<br>
					<h3>References</h3>
					
					MITRE_T1565_data_manipulation: [https://attack.mitre.org/techniques/T1565/]<br>
					
                </td>
            </tr>
</table>
<br>
<hr>
</div></div>
</body>
</html>
